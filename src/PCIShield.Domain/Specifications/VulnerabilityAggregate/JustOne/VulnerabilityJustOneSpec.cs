using System;
using System.Linq;
using Ardalis.GuardClauses;
using Ardalis.Specification;
using  PCIShield.Domain.Entities;
using  PCIShield.Domain.ModelEntityDto;
  	  
namespace  PCIShield.Domain.Specifications
{
    public class VulnerabilityByIdJustOneSpec : Specification<Vulnerability, VulnerabilityEntityDto>
    {
        public VulnerabilityByIdJustOneSpec(Guid vulnerabilityId)
        {
            _ = Guard.Against.NullOrEmpty(vulnerabilityId, nameof(vulnerabilityId));
            _ = Query.Where(vulnerability => vulnerability.VulnerabilityId == vulnerabilityId);
            _ = Query
                .Select(x => new VulnerabilityEntityDto
                {
                    VulnerabilityId = x.VulnerabilityId,
                    AssetId = x.AssetId,
                })
                .AsNoTracking()
                .EnableCache($"VulnerabilityByIdJustOne-{vulnerabilityId.ToString()}");
        }
    }
}

